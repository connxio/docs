"use strict";(self.webpackChunkconnxio_docs=self.webpackChunkconnxio_docs||[]).push([[4572],{44095:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>h,contentTitle:()=>l,default:()=>g,frontMatter:()=>a,metadata:()=>c,toc:()=>d});var s=n(85893),i=n(11151),o=n(59637),r=n(44996);const a={},l="Azure Storage",c={id:"integrations/adapters/inbound/azure-storage",title:"Azure Storage",description:"Connxio lets customers provide messages to the Connxio pipeline by configuring connections to Azure Storage accounts. We currently support messages as blobs or files. This page details how to configure Azure storage connections and what functionality is available by delivering files through this medium.",source:"@site/../docs/integrations/adapters/inbound/azure-storage.md",sourceDirName:"integrations/adapters/inbound",slug:"/integrations/adapters/inbound/azure-storage",permalink:"/docs/integrations/adapters/inbound/azure-storage",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"connxioSidebar",previous:{title:"Connxio API",permalink:"/docs/integrations/adapters/inbound/api"},next:{title:"Email",permalink:"/docs/integrations/adapters/inbound/email"}},h={},d=[{value:"Configuring the Azure Storage adapter",id:"configuring-the-azure-storage-adapter",level:2},{value:"Data Lake",id:"data-lake",level:2},{value:"Leasing",id:"leasing",level:2},{value:"Retry",id:"retry",level:2}];function u(e){const t={a:"a",em:"em",h1:"h1",h2:"h2",img:"img",li:"li",p:"p",strong:"strong",ul:"ul",...(0,i.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.h1,{id:"azure-storage",children:"Azure Storage"}),"\n",(0,s.jsxs)(t.p,{children:["Connxio lets customers provide messages to the Connxio pipeline by configuring connections to Azure Storage accounts. We currently support messages as ",(0,s.jsx)(t.a,{href:"https://azure.microsoft.com/en-us/services/storage/blobs/",children:"blobs"})," or ",(0,s.jsx)(t.a,{href:"https://docs.microsoft.com/en-us/azure/storage/files/storage-how-to-create-file-share?tabs=azure-portal",children:"files"}),". This page details how to configure Azure storage connections and what functionality is available by delivering files through this medium."]}),"\n",(0,s.jsx)(t.h2,{id:"configuring-the-azure-storage-adapter",children:"Configuring the Azure Storage adapter"}),"\n",(0,s.jsx)(t.p,{children:'To configure Connxio to start picking your messages select the Azure Storage option in "Inbound Connection" shape:'}),"\n","\n","\n",(0,s.jsx)("div",{style:{maxWidth:"400px"},children:(0,s.jsx)(o.default,{alt:"Configuring inbound connection",sources:{light:(0,r.default)("/img/docs/inbound-connection-light.webp"),dark:(0,r.default)("/img/docs/inbound-connection-dark.webp#dark-only")}})}),"\n",(0,s.jsx)("br",{}),"\n",(0,s.jsx)(t.p,{children:"The following properties are used to configure the adapter:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Polling Interval"}),": Dictates when files are picked from the Azure Storage account. The minimum interval allowed at this time is 60 seconds. You can specify intervals by typing in seconds."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Storage type"}),": Select storage type to use. Types include: Blob, File, Queue and Table."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Connection String Security Configuration"}),": Reference to the ",(0,s.jsx)(t.a,{href:"/connxio-portal/security-configurations",children:"Security Configuration"})," that contains the relevant connection properties."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Container Name"}),": The name of the container. This container must exist before Connxio start picking messages. We will not create it for you."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Directory"}),": Specifies which directory Connxio should target for file pickup. If this is kept blank the root directory is used (Azure Storage ",(0,s.jsx)(t.em,{children:"File Share"})," only)."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Batch Size"}),": The number of messages to in a single thread. The lower the number the more threads are spawned, ie. 1000 messages are stored on blob, batch size is set to 100, Connxio reads that there are 1000 files and spawns 10 parallel threads for pickup and processing."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"File Pick Limit"}),": The amount of files to pick per run of the engine. If polling interval is set to 1 minute and this variable is set to 1 message, Connxio will pick 1 message per minute. This variable is primarily used to slow down message processing to not kill receiving services."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"File Pick Sort Type"}),": Changed the way files are sorted when ",(0,s.jsx)(t.strong,{children:"File Pick Limit"})," is used. Has no effect without ",(0,s.jsx)(t.strong,{children:"File Pick Limit"}),"."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Ignore Inbound MetaData"}),": If enabled, the adapter will ignore all blob related metadata, such as interchangeId."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Regex Filter:"})," An inclusive regex filter that lets you pick only the messages matching the supplied regex. We use the standard C# regex syntax."]}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"data-lake",children:"Data Lake"}),"\n",(0,s.jsx)(t.p,{children:"Connxio supports data lake for Azure Storage Blob. We flatten the folder architecture and get all files on the file system. No changes are needed for your configuration when using data lake functionality."}),"\n",(0,s.jsx)(t.h2,{id:"leasing",children:"Leasing"}),"\n",(0,s.jsxs)(t.p,{children:["The Azure Storage inbound adapter uses leasing to ensure that only one process is picking from the server at any one time. This prevents deadlocks and race conditions towards files on the Azure Storage area. By default the leasing is set to the ",(0,s.jsx)(t.em,{children:"polling interval"}),", which means that the thread processing the Azure Storage files is the sole worker for the same duration as the interval between polling. This is usually very effective as you ensure that only one process contacts the resource for every time you poll against it."]}),"\n",(0,s.jsxs)(t.p,{children:["If you have an account with a lot of messages arriving continually however, this can cause problems. This is because you probably want the process from Connxio to poll every minute to pick up files as fast as possible, but since new files are arriving constantly you cant guarantee that the process will finish before the minute mark which causes a new process to be created after the leasing has run out. This in turn causes multiple processes from Connxio to process the same files at the same time. This doesn't cause duplicates but ",(0,s.jsx)(t.em,{children:"can"})," cause race condition where already picked files are processed by both threads at the same time."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{src:"https://cmhpictsa.blob.core.windows.net/pictures/Sftp%20inbound%20process%20lock.png?sv=2021-04-10&st=2022-12-01T07%3A54%3A23Z&se=2040-12-02T07%3A54%3A00Z&sr=b&sp=r&sig=YBfEB8vwE2PXr1tA0T%2BoE7sA8Z6swBtKJjVeLfL7PAE%3D",alt:"img"})}),"\n",(0,s.jsxs)(t.p,{children:["To solve this problem we have added the ",(0,s.jsx)(t.em,{children:"Use Process Lock"})," option which lets you lock the process for the time the process takes to complete. This can cause the ",(0,s.jsx)(t.em,{children:"polling interval"})," to become erratic as a new process is not allowed to start before the first one finishes. This will prevent race conditions when long running processes on constantly filling servers are causing problems. It's up to you as customers to enable this when needed as it depends on the server and load."]}),"\n",(0,s.jsx)(t.h2,{id:"retry",children:"Retry"}),"\n",(0,s.jsxs)(t.p,{children:["Since Connxio reaches out and picks up files when using Azure Storage, retry is handled by the Connxio framework. If a fault happens when the polling interval hits, the integration will be marked for execution at the next interval, which is after 60 seconds. This means that even if you have the polling interval set to trigger hourly or event daily, Connxio will try to execute the configuration every minute util it succeeds. This does not happen if the message is already picked up however since Connxio cant be sure the message is possible to requeue on the external storage. The message will then be sent to catastrophic retry as described in the ",(0,s.jsx)(t.a,{href:"/integrations/retry",children:"Retry Page"}),"."]})]})}function g(e={}){const{wrapper:t}={...(0,i.a)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(u,{...e})}):u(e)}},11151:(e,t,n)=>{n.d(t,{Z:()=>a,a:()=>r});var s=n(67294);const i={},o=s.createContext(i);function r(e){const t=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),s.createElement(o.Provider,{value:t},e.children)}}}]);